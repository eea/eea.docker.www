version: '2'
services:
  postgres-master:
    image: eeacms/postgres:${POSTGRES_VERSION}
    labels:
      io.rancher.scheduler.affinity:host_label: www=yes,db-master=yes
      postgres: 'yes'
    environment:
      POSTGRES_USER: "postgres"
      POSTGRES_PASSWORD: "postgres"
      POSTGRES_DBNAME: "datafs zasync"
      POSTGRES_DBUSER: "zope"
      POSTGRES_DBPASS: "zope"
      POSTGRES_CRON_1: ${POSTGRES_CRON_1}
      TZ: ${TZ}
    volumes:
    - www-postgres-dump:/postgresql.backup
    - www-postgres-restore:/var/lib/postgresql/data
volumes:
  www-postgres-dump:
    external: true
    volume_driver: ${VOLUME_DRIVER}
  www-postgres-restore:
    external: true
    volume_driver: ${VOLUME_DRIVER}
